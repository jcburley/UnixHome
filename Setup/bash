#!/bin/bash

UNIXHOME=~/.unixhome

if cp --help > /dev/null 2>&1; then
    CP=cp
else
    CP=gcp
    if ! $CP --help > /dev/null 2>&1; then
        echo >&2 "ERROR: please install GNU coreutils first, so 'gcp' invokes GNU 'cp'."
        exit 99
    fi
fi

if tail --help > /dev/null 2>&1; then
    TAIL=tail
else
    TAIL=gtail
    if ! $TAIL --help > /dev/null 2>&1; then
        echo >&2 "ERROR: please install GNU coreutils first, so 'tail' invokes GNU 'tail'."
        exit 99
    fi
fi

if [ -f ~/.bashrc ]; then
    if ! grep -qi .unixhome/etc/bashrc ~/.bashrc; then
	$TAIL -n +3 ${UNIXHOME}/etc/my-bashrc >> ~/.bashrc  # Skip hashbang and subsequent lines.
        echo "$0: appended my-bashrc to ~/.bashrc"
    fi
else
    $CP -v ${UNIXHOME}/etc/bashrc ~/.bashrc
fi

if [ -f ~/.bash_profile ]; then
    if ! grep -qi .unixhome/etc/bash_profile ~/.bash_profile; then
        $TAIL -n +3 ${UNIXHOME}/etc/my-bash_profile >> ~/.bash_profile  # Skip hashbang and subsequent lines.
        echo "$0: appended my-bash_profile to ~/.bash_profile"
    fi
else
    $CP -v ${UNIXHOME}/etc/bash_profile ~/.bash_profile
fi

if [ -f ~/.profile ]; then
    if ! grep -qi .unixhome/etc/profile ~/.profile; then
        $TAIL -n +3 ${UNIXHOME}/etc/my-profile >> ~/.profile  # Skip hashbang and subsequent lines.
        echo "$0: appended my-profile to ~/.profile"
    fi
else
    $CP -v ${UNIXHOME}/etc/profile ~/.profile
fi
