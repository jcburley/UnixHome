#!/bin/bash

export BASH_PROFILE_HAS_RUN=true

export UNIXHOME=$(~/.unixhome "$UNIXHOME" "$PS1")

[ -d "$UNIXHOME"/etc/functions ] && . "$UNIXHOME"/etc/functions

# Pull in .profile, which e.g. MacPorts creates to prepend to $PATH.
[ -f ~/.profile ] && . ~/.profile

# Get the aliases and functions.
if [ -z "$BASHRC_HAS_RUN" ] && [ -f $HOME/.bashrc ]; then
    source $HOME/.bashrc
fi

# Use Emacs if installed. (Git bash which does not support -s.)
if which emacs >/dev/null 2>&1; then
    export EDITOR=emacs
    export GIT_EDITOR=emacs
    export VISUAL=emacs
fi

PATHDIRS="$HOME/bin $HOME/googlesource/depot_tools"

for pd in $PATHDIRS; do
    [ -d "$pd" ] && not_in_path "$pd" "$PATH" && PATH=$PATH:$pd
done

export PATH

if [ -d /var/qmail/man ] && not_in_path "/var/qmail/man" "$MANPATH"; then
    export MANPATH="$MANPATH:/var/qmail/man"  # Empty before ':' means use config, so this is okay.
fi

# Get git goodness in prompts. See bashrc for PS1 and PROMPT_COMMAND
# definitions including $SHLVL. NOTE: __git_ps1 rewrites $PS1!!
export PS1='[\u@\h \W$(__git_ps1 " (%s)")]\$ '
export PROMPT_COMMAND='__git_ps1 "\u@\h:\w" "\\\$ "'

export GIT_PS1_SHOWDIRTYSTATE=t
export GIT_PS1_SHOWSTASHSTATE=t
export GIT_PS1_SHOWUPSTREAM="verbose"

export GITBASE=git@github.com:jcburley

# GoLang
if [ -d /usr/local/go ]; then
    export GOROOT=/usr/local/go
    not_in_path "$GOROOT/bin" "$PATH" && export PATH=$PATH:$GOROOT/bin
fi
if [ -d "$HOME/.go" ]; then
    export GOPATH=$HOME/.go
    not_in_path "$GOPATH/bin" "$PATH" && export PATH=$PATH:$GOPATH/bin
fi
